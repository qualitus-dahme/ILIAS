/**
 * This file is part of ILIAS, a powerful learning management system
 * published by ILIAS open source e-Learning e.V.
 *
 * ILIAS is licensed with the GPL-3.0,
 * see https://www.gnu.org/licenses/gpl-3.0.en.html
 * You should have received a copy of said license along with the
 * source code, too.
 *
 * If this is not the case or you just want to try ILIAS, you'll find
 * us at:
 * https://www.ilias.de
 * https://github.com/ILIAS-eLearning
 */
!function(e){"use strict";const t='[name*="[position]"',n='[name*="[indentation]"',o="dd-item",r="c-test__dropzone";function s(e,r,s){!function(e,t,r){let s=0,l=t.parentElement.parentElement;for(;l!==r;)l=l.parentElement.parentElement,s+=1;e.querySelector(n).value=s,e.querySelectorAll(`.${o}`).forEach((e=>{s+=1,e.querySelector(n).value=s}))}(e,r,s),function(e){let n=0;e.querySelectorAll(`.${o}`).forEach((e=>{e.querySelector(t).value=n,n+=1}))}(s)}function l(e,t){!function(e){const t=e.querySelector(`.${r}`);e.querySelectorAll(`.${o}`).forEach((e=>{e.previousElementSibling?.classList.contains(r)||e.parentNode.insertBefore(t.cloneNode(),e),e.nextElementSibling?.classList.contains(r)||e.parentNode.insertBefore(t.cloneNode(),e.nextElementSibling)})),e.querySelectorAll(`.${r} + .${r}`).forEach((e=>{e.remove()}))}(t),e.previousElementSibling?.classList.contains(r)&&e.previousElementSibling.remove(),e.nextElementSibling?.classList.contains(r)&&e.nextElementSibling.remove()}function i(e,t){!function(e){const t=e.querySelectorAll(`.${o}`);let n=0;t.forEach((e=>{e.offsetHeight<n&&(n=e.offsetHeight)})),e.querySelectorAll(`.${r}`).forEach((e=>{e.style.height=`${t.item(0).offsetHeight}px`}))}(e),t("move",e,o,r,((t,n)=>{s(t,n,e)}),(t=>{l(t,e)}))}const c="c-test__dropzone--active",a="c-test__dropzone--hover";function d(e,t,n,o,r,s){let l,i,d;function f(t){setTimeout((()=>{v(t.target),t.dataTransfer.dropEffect=e,t.dataTransfer.effectAllowed=e,t.dataTransfer.setDragImage(d,0,0)}),0)}function u(e){e.preventDefault(),e.stopPropagation(),v(e.target.closest(`.${n}`));const t=d.offsetWidth,o=d.offsetHeight;l=d.cloneNode(!0),d.parentNode.insertBefore(l,d),d.style.position="fixed",d.style.left=e.touches[0].clientX-t/2+"px",d.style.top=e.touches[0].clientY-o/2+"px",d.style.width=`${t}px`,d.style.height=`${o}px`,d.addEventListener("touchmove",h),d.addEventListener("touchend",L)}function v(e){d=e,d.style.opacity=.5,s(d),t.querySelectorAll(`.${o}`).forEach((e=>{q(e),e.classList.add(c)})),d.querySelectorAll(`.${o}`).forEach((e=>{e.classList.remove(c)}))}function h(e){e.preventDefault(),d.style.left=e.touches[0].clientX-d.offsetWidth/2+"px",d.style.top=e.touches[0].clientY-d.offsetHeight/2+"px";const{documentElement:n}=t.ownerDocument;e.touches[0].clientY>.8*n.clientHeight&&n.scroll({left:0,top:.8*e.touches[0].pageY,behavior:"smooth"}),e.touches[0].clientY<.2*n.clientHeight&&n.scroll({left:0,top:.8*e.touches[0].pageY,behavior:"smooth"});const r=t.ownerDocument.elementsFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY).filter((e=>e.classList.contains(o)));0===r.length&&void 0!==i&&(i.classList.remove(a),i=void 0),1===r.length&&i!==r[0]&&(void 0!==i&&i.classList.remove(a),[i]=r,i.classList.add(a))}function m(e){e.preventDefault()}function g(e){e.target.classList.add(a)}function p(e){e.target.classList.remove(a)}function E(){d.removeAttribute("style"),t.querySelectorAll(`.${o}`).forEach((e=>{e.classList.remove(c),e.classList.remove(a)}))}function y(e){e.preventDefault(),S(e.target)}function L(e){e.preventDefault();const n=t.ownerDocument.elementsFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY).filter((e=>e.classList.contains(o)));E(),l.remove(),1===n.length&&S(n[0])}function S(t){const n=d.parentNode;let o=d;"move"!==e&&(o=d.cloneNode(!0),o.style.opacity=null,$(o)),t.parentNode.insertBefore(o,t),r(o,t,d,n)}function $(e){e.addEventListener("dragstart",f),e.addEventListener("dragend",E),e.addEventListener("touchstart",u)}function q(e){e.removeEventListener("dragover",m),e.removeEventListener("dragenter",g),e.removeEventListener("dragleave",p),e.removeEventListener("drop",y),e.addEventListener("dragover",m),e.addEventListener("dragenter",g),e.addEventListener("dragleave",p),e.addEventListener("drop",y)}t.querySelectorAll(`.${n}`).forEach($),t.querySelectorAll(`.${o}`).forEach(q)}e.test=e.test||{},e.test.orderingvertical=e.test.orderingvertical||{},e.test.orderingvertical.init=e=>i(e,d)}(il);
